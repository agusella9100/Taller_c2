Version 4
SHEET 1 6000 2436
WIRE 800 -1232 672 -1232
WIRE 928 -1232 880 -1232
WIRE 1056 -1232 928 -1232
WIRE 1168 -1216 1120 -1216
WIRE 1248 -1216 1168 -1216
WIRE 1376 -1216 1328 -1216
WIRE 1472 -1216 1376 -1216
WIRE 1056 -1200 1024 -1200
WIRE 1600 -1200 1536 -1200
WIRE 1648 -1200 1600 -1200
WIRE 928 -1184 928 -1232
WIRE 1472 -1184 1440 -1184
WIRE 1024 -1136 1024 -1200
WIRE 1168 -1136 1168 -1216
WIRE 1168 -1136 1024 -1136
WIRE 1440 -1088 1440 -1184
WIRE 1488 -1088 1440 -1088
WIRE 1600 -1088 1600 -1200
WIRE 1600 -1088 1568 -1088
WIRE 800 -1040 672 -1040
WIRE 928 -1040 880 -1040
WIRE 1056 -1040 928 -1040
WIRE 1184 -1024 1120 -1024
WIRE 1248 -1024 1184 -1024
WIRE 1376 -1024 1376 -1216
WIRE 1376 -1024 1328 -1024
WIRE 1440 -1024 1440 -1088
WIRE 928 -1008 928 -1040
WIRE 1056 -1008 1024 -1008
WIRE 2224 -960 2144 -960
WIRE 2368 -960 2304 -960
WIRE 1024 -944 1024 -1008
WIRE 1184 -944 1184 -1024
WIRE 1184 -944 1024 -944
WIRE 2592 -944 2592 -960
WIRE 1968 -848 1872 -848
WIRE 2144 -848 2144 -960
WIRE 2144 -848 2048 -848
WIRE 2592 -848 2592 -944
WIRE 2144 -816 2144 -848
WIRE 2224 -816 2144 -816
WIRE 2368 -800 2368 -960
WIRE 2368 -800 2288 -800
WIRE 2416 -800 2368 -800
WIRE 2528 -800 2496 -800
WIRE 2224 -784 2144 -784
WIRE 1264 -752 1152 -752
WIRE 1408 -752 1344 -752
WIRE 1968 -736 1872 -736
WIRE 2096 -736 2048 -736
WIRE 2144 -736 2144 -784
WIRE 2144 -736 2096 -736
WIRE 2592 -704 2592 -752
WIRE 336 -672 336 -720
WIRE 512 -672 512 -720
WIRE 1008 -672 912 -672
WIRE 1152 -672 1152 -752
WIRE 1152 -672 1088 -672
WIRE 1232 -672 1152 -672
WIRE 2096 -656 2096 -736
WIRE 1232 -624 1232 -672
WIRE 1264 -624 1232 -624
WIRE 1408 -608 1408 -752
WIRE 1408 -608 1328 -608
WIRE 1456 -608 1408 -608
WIRE 1264 -592 1232 -592
WIRE 2592 -592 2592 -624
WIRE 1008 -544 912 -544
WIRE 1152 -544 1088 -544
WIRE 1232 -544 1232 -592
WIRE 1232 -544 1152 -544
WIRE 336 -528 336 -592
WIRE 512 -528 512 -592
WIRE 2096 -528 2096 -576
WIRE 1152 -480 1152 -544
WIRE 1152 -368 1152 -400
WIRE 96 -32 -240 -32
WIRE 320 -32 96 -32
WIRE 640 -32 320 -32
WIRE 784 -32 736 -32
WIRE 1024 -32 1024 -192
WIRE 1024 -32 784 -32
WIRE 1072 -32 1024 -32
WIRE 1232 -32 1232 -192
WIRE 1232 -32 1152 -32
WIRE 1472 -32 1232 -32
WIRE 1840 -32 1472 -32
WIRE 2000 -32 1840 -32
WIRE 1472 16 1472 -32
WIRE 208 96 160 96
WIRE 256 96 208 96
WIRE 1472 112 1472 96
WIRE 1472 112 1392 112
WIRE 1776 112 1712 112
WIRE 688 128 688 32
WIRE 784 128 784 -32
WIRE 1472 144 1472 112
WIRE -240 176 -240 -32
WIRE 96 176 96 144
WIRE 208 176 208 96
WIRE 208 176 96 176
WIRE 320 208 320 144
WIRE 736 208 736 192
WIRE 736 208 320 208
WIRE 928 208 736 208
WIRE 96 304 96 176
WIRE 320 304 320 208
WIRE 1840 304 1840 -32
WIRE 2000 304 2000 -32
WIRE 1472 320 1472 224
WIRE 1600 320 1472 320
WIRE 1712 320 1712 112
WIRE 32 352 -32 352
WIRE 1392 352 1392 112
WIRE 1392 352 384 352
WIRE -32 400 -32 352
WIRE 1712 400 1648 400
WIRE 1472 416 1472 320
WIRE 96 432 96 400
WIRE 208 432 96 432
WIRE 320 432 320 400
WIRE 320 432 208 432
WIRE 208 464 208 432
WIRE 1712 496 1712 400
WIRE -240 576 -240 256
WIRE -32 576 -32 480
WIRE -32 576 -240 576
WIRE 208 576 208 544
WIRE 208 576 -32 576
WIRE 1472 576 1472 496
WIRE 1472 576 208 576
WIRE 1600 576 1600 416
WIRE 1600 576 1472 576
WIRE 1712 576 1600 576
WIRE 1840 576 1840 384
WIRE 1840 576 1712 576
WIRE 2000 576 2000 368
WIRE 2000 576 1840 576
FLAG 208 576 0
FLAG 1840 -32 Vo
FLAG -32 352 Vref
FLAG -240 -32 VIN
FLAG 1392 112 Vf
FLAG 1776 192 0
FLAG 1232 -192 Vs-
FLAG 1024 -192 Vs+
FLAG 912 -672 Vs-
FLAG 912 -544 Vs+
FLAG 1152 -368 0
FLAG 1456 -608 VS
FLAG 928 -1104 0
FLAG 928 -928 0
FLAG 1440 -944 0
FLAG 672 -1232 Vref
FLAG 672 -1040 Vf
FLAG 1648 -1200 Vref-c
FLAG 2096 -528 0
FLAG 2592 -592 0
FLAG 1872 -848 Vref-c
FLAG 1872 -736 VS
FLAG 2592 -944 Verror
FLAG 928 208 Verror
FLAG 336 -528 0
FLAG 336 -720 V+
FLAG 512 -720 V-
FLAG 512 -528 0
FLAG 1088 -992 V+
FLAG 1296 -640 V+
FLAG 1296 -576 V-
FLAG 1088 -1184 V+
FLAG 1088 -1056 V-
FLAG 1088 -1248 V-
FLAG 1504 -1232 V-
FLAG 1504 -1168 V+
FLAG 2256 -832 V+
FLAG 2256 -768 V-
DATAFLAG 1680 -32 ""
DATAFLAG 624 352 ""
SYMBOL pnp 160 144 R180
SYMATTR InstName Q1
SYMATTR Value BC557C
SYMBOL pnp 256 144 M180
SYMATTR InstName Q2
SYMATTR Value BC557C
SYMBOL npn 32 304 R0
SYMATTR InstName Q3
SYMATTR Value BC547C
SYMBOL npn 384 304 M0
SYMATTR InstName Q4
SYMATTR Value BC547C
SYMBOL res 192 448 R0
SYMATTR InstName R1
SYMATTR Value 500
SYMBOL pnp 736 32 M270
SYMATTR InstName Q5
SYMATTR Value 2SB772
SYMBOL npn 688 192 R270
SYMATTR InstName Q6
SYMATTR Value 2N4401
SYMBOL res 1456 0 R0
WINDOW 0 44 33 Left 2
WINDOW 3 38 73 Left 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 1456 128 R0
SYMATTR InstName R6
SYMATTR Value 3.3k
SYMBOL res 1824 288 R0
SYMATTR InstName RL
SYMATTR Value {RL}
SYMBOL voltage -32 384 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VREFAC}
SYMATTR InstName V1
SYMATTR Value {VREFDC}
SYMBOL voltage -240 160 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VINAC}
SYMATTR InstName VIN
SYMATTR Value {VINDC}
SYMBOL res 80 -48 R0
SYMATTR InstName R8
SYMATTR Value {RE}
SYMBOL res 304 -48 R0
SYMATTR InstName R9
SYMATTR Value {RE}
SYMBOL cap 1984 304 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res 1456 400 R0
SYMATTR InstName R88
SYMATTR Value 2.7k
SYMBOL nmos 1648 320 M0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res 1696 480 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 1696 304 R0
SYMATTR InstName R99
SYMATTR Value 10k
SYMBOL voltage 1776 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {Vllave}
SYMBOL res 1056 -16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 0.1
SYMBOL res 992 -528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value {Rvs}
SYMBOL res 1104 -688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {Rvs}
SYMBOL res 1248 -736 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value {10*Rvs}
SYMBOL res 1136 -496 R0
SYMATTR InstName R10
SYMATTR Value {10*Rvs}
SYMBOL res 896 -1248 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {5*Rtilde}
SYMBOL res 912 -1200 R0
SYMATTR InstName R13
SYMATTR Value {Rtilde}
SYMBOL res 912 -1024 R0
SYMATTR InstName R14
SYMATTR Value {4.6*Rtilde}
SYMBOL res 896 -1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value {5.44*Rtilde}
SYMBOL res 1344 -1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {Rgrande}
SYMBOL res 1344 -1232 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value {Rgrande}
SYMBOL res 1584 -1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value {Rx}
SYMBOL res 1456 -928 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value {Rx}
SYMBOL res 2064 -832 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value {Ra}
SYMBOL res 2064 -720 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R21
SYMATTR Value {Ra}
SYMBOL res 2080 -560 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R22
SYMATTR Value {Rb}
SYMBOL res 2320 -944 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R23
SYMATTR Value {Rb}
SYMBOL res 2512 -816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL npn 2528 -848 R0
SYMATTR InstName Q7
SYMATTR Value BC847C
SYMBOL voltage 336 -688 R0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL voltage 512 -688 R0
SYMATTR InstName V4
SYMATTR Value -5
SYMBOL OpAmps\\UniversalOpAmp2 1296 -608 R0
SYMATTR InstName U1
SYMBOL OpAmps\\UniversalOpAmp2 1088 -1216 M180
SYMATTR InstName U2
SYMBOL OpAmps\\UniversalOpAmp2 1088 -1024 M180
SYMATTR InstName U3
SYMBOL OpAmps\\UniversalOpAmp2 1504 -1200 M180
SYMATTR InstName U4
SYMBOL OpAmps\\UniversalOpAmp2 2256 -800 R0
SYMATTR InstName U5
SYMBOL res 2576 -720 R0
SYMATTR InstName R25
SYMATTR Value 100
TEXT -240 560 Left 2 !.op
TEXT -248 624 Left 2 !.param VINDC=6.35
TEXT -248 664 Left 2 !.param VINAC 1
TEXT 80 624 Left 2 !.param VREFDC 1.2
TEXT 80 664 Left 2 !.param VREFAC 0
TEXT 424 624 Left 2 !;param RL 100
TEXT -248 712 Left 2 !;dc VIN 4 24
TEXT 832 664 Left 2 !;step param RE 1k 1.5k 100
TEXT 832 624 Left 2 !.param RE 470
TEXT 416 664 Left 2 !.step param RL 20 1 0.2
TEXT 2080 -16 Left 2 ;Mido regulacion de linea
TEXT 2080 24 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=12
TEXT 2080 48 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=24
TEXT 2080 72 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/12)
TEXT 2080 128 Left 2 ;Mido regulacion de carga
TEXT 2080 168 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT 2080 192 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 5
TEXT 2080 216 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT 2080 240 Left 2 !.meas OP Io2rc FIND I(RL) AT 5
TEXT 2088 304 Left 2 ;Mido eficiencia
TEXT 2088 344 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT 2080 264 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT 1272 616 Left 2 !;step param Vllave list 0 6
TEXT 1896 -1112 Left 2 ;//porque usamos un seguidor en vez de poner el divisor directo a la entrada
TEXT 1632 -512 Left 2 !;step param Rtilde 1k 5 10
TEXT 1688 -472 Left 2 !.param Rtilde 10k
TEXT 1704 -432 Left 2 !.param Rvs 10k
TEXT 1728 -1072 Left 2 ;//R17 y 16 no son Rtilde, deben ser grandes para no cargar. Despues estan en paralelo para definir R21.
TEXT 2056 -400 Left 2 !.param Ra 1k
TEXT 2056 -368 Left 2 !.param Rb 500k
TEXT 2024 -336 Left 2 !.param Rgrande 100k
TEXT 2056 -432 Left 2 !.param Rx 100k
TEXT 1280 656 Left 2 !.param Vllave 6
TEXT -576 -288 Left 2 !.model 2SB772 PNP(Is=282f Xti=3 Eg=1.11 Vaf=100 Bf=213.6 Ise=1.659p Ne=1.787 Ikf=6.472 Nk=.7894 Xtb=1.5 Var=100 Br=39.18 Isc=12.72p Nc=1.637 Ikr=.1652 Rc=64.89m Cjc=145.6p Mjc=.2985 Vjc=.3905 Fc=.5 Cje=255.3p Mje=.5064 Vje=1.615 Tr=10n Tf=1.927n Itf=6.218 Xtf=0 Vtf=10)
